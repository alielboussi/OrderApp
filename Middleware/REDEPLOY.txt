Middleware service redeploy (Windows)

1) Stop and remove old service
- Open Services (services.msc)
- Find: Ultra Automatic Screen Saver
- Stop it
- Open an elevated Command Prompt and run:
  sc stop UltraAutomaticScreenSaver
  sc delete UltraAutomaticScreenSaver

2) Install the new service
Option A: Run the installer EXE (recommended)
- Build the installer once:
  cd Middleware\installer
  dotnet publish -c Release -r win-x64 --self-contained true
- Copy the installer EXE output folder contents into Middleware\service
- Copy the published service files (UltraAutomaticScreenSaver.exe and all dlls) into Middleware\service
- Run Middleware\service\InstallMiddleware.exe as Administrator

Option B: Use the PowerShell installer
- Copy published service files into Middleware\ (same folder as install-service.ps1)
- Run install-service.bat as Administrator

3) Configure
- Edit %LOCALAPPDATA%\Ultra Automatic Screen Saver\appsettings.json
- Set Outlet:Id, Supabase Url/ServiceKey, and Sync:MinSaleDateUtc

4) Start service
- In Services, start Ultra Automatic Screen Saver

Notes
- The tray UI uses the same config file in %LOCALAPPDATA%\Ultra Automatic Screen Saver.
- After changing Sync:MinSaleDateUtc, restart the service.
